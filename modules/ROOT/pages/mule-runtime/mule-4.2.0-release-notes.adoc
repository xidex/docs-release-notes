// Product_Name Version number/date Release Notes
= Mule Runtime 4.2.0 Release Notes
:keywords: mule, 4.2.0, runtime, release notes

*May 6, 2019*

Mule Runtime 4.2.0 includes the following enhancements, changes, and fixes.

== Mule Runtime Features and Enhancements

* Fedramp support
* Performance improvements
* Faster start time
* <<java_11>>

[[java_11]]
=== Java 11 support

* Java support is extended to Java 11. Note that AdoptOpenJDK 8 is
recommended over Java 11 and other Java 8 SDKs.
+
In addition:
+
  ** Your app development and production environments should run on the
     the same JDK versions.
  ** For custom connectors built with the Mule SDK, you
     still need to compile against Java 8, but MuleSoft supports running
     them on Java 11 or Java 8.
  ** At the moment, the following connectors only support Java 8:
  *** DotNet
  *** Dynamics CRM
  *** Dynamics NAV
  *** Netsuite
  *** Oracle EBS 12.1
  *** Oracle EBS 12.2

* To configure JDK 11 in Anypoint Studio, see xref:7.3@studio::change-jdk-config-in-projects.adoc[Change the JDK from Studio].

== API Gateway Features and Enhancements

* Improved security, which allows for the encryption of credentials used
to configure the connection between the runtime and Anypoint Platform,
as well as encrypting all sensitive information stored by the Gateway,
such as policies configuration and contracts.
* Analytics can now be configured to send data both to Anypoint Platform
and to process the events through Anypoint Runtime Manager. The latest allows
you to set third-party systems such as Splunk to consume the Analytics info.
* This version introduces support to use Mule 4.0’s OAuth 2.0 Provider for the
“OAuth 2.0 Access Token Enforcement Using Mule OAuth Provider” policy.
* Performance improvements on policies and proxy applications.
* To reduce log verbosity, some logs where moved from INFO to DEBUG level:
 ** `{} events from {} were sent to analytics ingest`
 ** `Starting API Gateway runnables`

== DataWeave Features and Enhancements

* DataWeave 2.2.0 is released as part of Mule 4.2.

* New DataWeave Language Syntax:
 ** New support for annotations. The annotation processor is native only.
 ** DataWeave introduces the `!` as an alternative to `not` operator.
+
NOTE: Though the semantics is the same, the precedence is different.
`not true | true` returns `false`, and `!true|true` return `true`
because `not` has a lower precedence and is therefore executed as
`not (true|true)`.

* New and Modified DataWeave Function Modules:
** Arrays (dw::core::Arrays) has new functions: `drop`, `dropWhile`, `indexOf`,
`indexWhere`,`join`, `leftJoin`, `outerJoin`, `partition`, `slice`, `splitAt`,
`splitWhere` `take`, `takeWhile`
** Binaries (`dw::core::Binaries`) has new functions: `readLinesWith` and
`writeLinesWith`
** Core (`dw:Core`) includes a new data type and a number of annotations:
  *** `TailRec` annotation: Validates that a function is tail recursive.
  *** `DesignOnlyType` annotation
  *** `StreamCapable` annotation
  *** `Pair` type
** Crypto (`dw::Crypto`): The `algorithm` parameter to the `HMACWith`
   function is new. It supports custom algorithms.
** DataFormat (`dw::extension::DataFormat`) is new and has all the functionality
   needed to define a custom data format (`DataFormat`) in DataWeave. The module
   includes its own types and annotations.
** Mule (`Mule`) module and all of its functions and types are new.
** Multipart (`dw::module::Multipart`)  and all its functions and types are new.
** Numbers (`dw::core::Numbers`) is a new DataWeave function module:
   `fromBinary`, `fromHex`, `fromRadixNumber`, `toBinary`, `toHex`,
   `toRadixNumber`
** Runtime (`dw::Runtime`) has new functions: `orElseTry` and `orElse`
** Strings (`dw::core::Strings`) has new functions:  `appendIfMissing`,
   `isAlpha`, `isAlphanumeric`, `isNumeric`, `isUpperCase`, `isLowerCase`,
   `isWhitespace`, `leftPad`, `prependIfMissing`, `repeat`, `rightPad`,
   `substringAfter`,  `substringAfterLast`, `substringBefore`,
   `substringBeforeLast`, `unwrap`, `wrapWith`, `wrapIfMissing`,

=== Runtime-related Features in DataWeave

* Encoding:
+
Starting in Mule 4.2, the default encoding is no longer the system
encoding but the encoding from the Mule app. This change is unlikely
to affect your Mule apps.

* New data formats:
 ** Avro (`application/avro`)
 ** ndjson (`application/x-ndjson`)
 ** Java Properties (`text/x-java-properties`)

* Multipart supports bigger than memory.

* New DataWeave reader and writer properties for supported formats:
** JSON:
  *** Writer property:
    **** `writeAttributes`: To keep the attributes (`false` by default).
    **** `deferred`: To force the execution to be deferred. This means that
         execution takes place on demand, which is useful for full streaming.
  *** Reader property:
    **** `streaming`: To enable streaming mode on the JSON reader. It only works
          for values that are arrays.
** Java:
   *** Writer properties:
     **** `writeAttributes`: To keep the attributes (`false` by default).
     **** `duplicatedKeysAsArray`: If there are duplicated keys, write it as an
           array (false by default)
     **** `writeAttributes`: To keep the attributes (`false` by default).
  *** Reader property:
     **** `streaming`: To enable streaming mode on the JSON reader. It only works
           for values that are arrays.
** All (except for Java):
   *** `deferred`: To force the execution to be deferred. This means that
       execution takes place on demand, which is useful for full streaming.

* New experimental option: There is a new tool for dumping the entire context
when a scripting fails. This is useful for reproducing any issue in a more
isolated environment:
 ** `-Dcom.mulesoft.dw.dump_files=true`: Dumps the context on an exception.
 ** `-Dcom.mulesoft.dw.dump_folder`: Specifies the directory in which to dump
     the context. The default is the `tmp` directory.


== Known Limitations and Workarounds

[%header,cols="15a,85a"]
|===
|Issue |Description
| MULE-16742 | XML attachment is corrupted when sent as multipart/form-data
| MULE-16735 | XML transformation to JSON fails when ? present in large payload
| MULE-16696 | Schedulers unavailable after disposing policies (rarely)
| MULE-16668 | Excessive validations on pooled connections.
| MULE-15752 | InjectParamsFromContextServiceMethodInvoker makes excessive registry lookups
|===

=== API Gateway Known Limitations and Workarounds

The HTTP Caching Policy v1.0.0 has been deprecated and is not compatible with Mule Runtime v4.2.0. Customers need to use or upgrade to v1.0.1 of the policy. The latest version introduces many bug fixes as well as performance improvements. Version 1.0.0 will continue to work with v4.1.x of the Runtime but customers are encouraged to upgrade to v1.0.1.

Customers that process analytic events through Anypoint Runtime Manager and send them to an external database need to run a migration because one field type was modified. It was modified to fix a bug with automated policies and for the reporting of policy violations. See xref:runtime-manager-agent/runtime-manager-agent-2.3.0-release-notes.adoc[Runtime Manager Agent 2.3.0 Release Notes].

== Upgrade Requirements

[%header,cols="15a,85a"]
|===
|Issue |Description
| MULE-15586 | "lookup` function in DataWeave now has a timeout. The timeout for a specific lookup call may be increased by providing the new value with a third parameter (i.e.: lookup(vars.flow, payload, 10000).
| MULE-15730 | TLS keystore entries must now reference at least one key to use or reference a key alias. Using an invalid keystore will result in an initialisation failure.
|===

== Fixed Issues

[%header,cols="15a,85a"]
|===
|Issue |Description
// Fixed Issues
| MULE-16689 | Lightweight class loader model builder cannot resolve a pom as it doesn't have the remote repositories from mule application where it was declared the dependency
| MULE-16678 | Disposing policies are generating stacktraces and hanging requests
| MULE-16672 | org.mule.runtime.api.util.ResourceLocator is caching resources and it nos working with SNAPSHOT dependencies
| MULE-16644 | PollingSources: ObjectStore names need to be part of the API
| MULE-16636 | CursorProvider is retained too long when cursors are opened but not consumed
| MULE-16634 | Source completion callback not called on failure
| MULE-16633 | Cool Mulesoft logo in splash screen looking bad in windows
| MULE-16621 | JMS with XA transaction stops consuming message on TX timeout
| MULE-16615 | Policy-specific schedulers are not stopped on application disposal
| MULE-16614 | Some core classes do not generate any logs
| MULE-16600 | Lazy Init: websockets:config is unable to find http:listener-config
| MULE-16581 | Runtime does not shutdown after OptionalLong[15000] milliseconds
| MULE-16580 | Spring Bean 3.1 XSD definition being downloaded instead of taken from the classpath
| MULE-16577 | Parse Template not parsing correctly when expression manager returns value with # char
| MULE-16575 | Mule hangs when raising a Custom Error
| MULE-16574 | Fix message propagation and variables scope in policies
| MULE-16572 | Spring XSD schemas fail to resolve for version 5+
| MULE-16571 | Externalize log4j2.xml file in Mule 4 domain descriptor cannot be cast to application descriptor
| MULE-16562 | Text plain writer fails with data > 1.5MB
| MULE-16551 | When Policy is present, Event is not serializable
| MULE-16545 | Exception ignored in Operators#nullSafeMap
| MULE-16540 | AuthorizationCodeState not updated on certain circumstances
| MULE-16537 | Error handling not working properly with foreach
| MULE-16524 | Before method is not called for interception API when having RequiredParameterValueResolvers with failing expression
| MULE-16519 | Avoid propagating InterruptedException in processingStragy dispose
| MULE-16517 | Policies are propagating before-source message even when propagateMessageTransformations is set to false
| MULE-16514 | Persistent Partiion Store should delete partiition directory on dispose
| MULE-16503 | Found modules names not being logged by DefaultModuleRepository
| MULE-16500 | Janitor must be closed so that taken byte arrays are freed when ghostbuster applied
| MULE-16483 | Mule Domain is not disposing its RegionClassLoader
| MULE-16480 | Incorrect behavior of Logger component when handling backslashes
| MULE-16456 | Blocking bug: modify the reference guide generated by SDK so all needed parameters are generated
| MULE-16455 | Name attribute on flow-ref is missing after deserializing from XML
| MULE-16449 | NoSuchElementException on policies with SDK routers
| MULE-16438 | Validators are not executed when compiling a connector with parent 1.2.0
| MULE-16435 | Extension operations logging in domain instead of app
| MULE-16422 | MuleArtifactClassLoader does not find resources with spaces when using resource:: syntax.
| MULE-16396 | OnErrorPropagate should only rollback owned transactions
| MULE-16392 | Fix ProcessingStrategies backpressureOnInnerCpuIntensiveSchedulerBusy flaky test
| MULE-16364 | ManagedStreams are not semantically scoped
| MULE-16348 | [REGRESSION] Error handler not working properly on a policy
| MULE-16330 | Logging consumes too much CPU
| MULE-16320 | Remove overhead in event/message creation handling in policies
| MULE-16319 | Container classloader in embedded mode must have the embedded container classloader as parent
| MULE-16314 | NPE if object store is expired without maxEntries limit
| MULE-16310 | Backpressure strategy for scheduler sources must be FAIL
| MULE-16308 | Local authentication doesn't prevail when there're multiple "WWW-Authenticate" headers
| MULE-16307 | Reconnection Strategy model doesn't communicate the "Blocking" parameter
| MULE-16298 | Redeployment fails due to file descriptor leaks when loading class model loader
| MULE-16294 | Paged Operations doesn't apply Connection Lifecycle correctly
| MULE-16289 | raise-error is not setting the description as payload when used in a policy.
| MULE-16282 | ProcessingStrategies not working when scheduler raises REE
| MULE-16281 | Tests for Emitter ProcessingStrategy with RateLimit policy scenario
| MULE-16275 | Fix performance degradation introduced by MULE-16040
| MULE-16260 | Gatekeeper policy causes memory leak on policy engine
| MULE-16259 | LazyMuleArtifactContext leaves schedulers not stopped when using sub-flows
| MULE-16230 | VersionFormatArtifactDescriptorValidator fails due to MavenBundleDescriptorLoader is not considering the effective pom model to read the version property
| MULE-16221 | HTTP:CONNECTIVITY error thrown from WSC hangs execution in CompositeProcessorChainRouter
| MULE-16219 | idempotent-message-validator does not generate a unique ID per component
| MULE-16218 | Interception API: Smart connectors inside subflow are not skipped properly
| MULE-16208 | Find resources is not taking into account lookup of files by directory
| MULE-16205 | IdempotentRedeliveryPolicy blocks CPU_LITE thread
| MULE-16198 | Deployment for app with HTTP fails when no internet connection
| MULE-16186 | ToolingApplicationDescriptorFactory is not setting the class loader model descriptor to the builder
| MULE-16185 | Lazy Init: NPE when initializing subflow twice with until-successful
| MULE-16179 | Java module don't work with literal reference in instance attribute
| MULE-16172 | Invalid extension model/xsd generated for enum
| MULE-16165 | FlowListener#onComplete() should await for root completion
| MULE-16159 | ProcessingStrategy internal bufferSize is always 256 for flow-ref
| MULE-16140 | Source On Error callback is not called when an error occurs on the OnError Flow Handlers
| MULE-16130 | transaction-manager not being lazy initialized
| MULE-16123 | Fix routeWithExpressionException test cases
| MULE-16110 | Use the UUID api instead of the library directly in test
| MULE-16109 | Tooling Applications should delete the applicationDataFolder when disposed
| MULE-16103 | Wrong key name is generated by the icons service in Windows
| MULE-16040 | Backpressure is not triggered by saturated CPU_INTENSIVE threadPool
| MULE-16037 | JreExplorer no properly determines JRE libs in Java 11
| MULE-16036 | Make `MediaTypeDecorated*Iterator` implement `HasSize`
| MULE-16034 | Http `uriParams` are represented as MultiMap instead of HashMap
| MULE-16033 | ArtifactCopyNativeLibraryFinder fails when copyNativeLibrary is executed if the artifactTempFolder contains a space
| MULE-16031 | SplitAggregateScope collection definition must be valid expression
| MULE-16025 | App directory is deleted in undeployment
| MULE-15994 | Executions inside Async scope uses Ring Buffer Threads
| MULE-15990 | Make Adaptor for ExpressionLanguageSession
| MULE-15981 | MEL fails to evaluate eventless expressions
| MULE-15976 | Backpressure: WAIT strategy does not work with WorkQueueProcessor
| MULE-15944 | Remove log message when classloader doesn't find AWS class
| MULE-15942 | 500 returned for scheduler busy in policy
| MULE-15940 | Interception: Processing a chain in 'before' causes null parameters
| MULE-15933 | File connector fails to recreate the input stream to a file when reconnection occurs in following components
| MULE-15932 | System dependent line separators should be used for building Mule exception summary message
| MULE-15931 | Mule fails to load all contracts in a service bundle
| MULE-15918 | Test and complete additionalPluginLibraries feature
| MULE-15916 | Http request hangs when there is a redelivery-policy and no failure
| MULE-15908 | Persistent ObjectStore doesn't regenerate the partition descriptor file after a clear
| MULE-15898 | Create a service for MetadataType Interaction with the expression language
| MULE-15886 | Mule 4.x Shell Script doens't pass environment variables to /sbin/runuser call
| MULE-15864 | Terminated Event instances are kept in memory
| MULE-15861 | Artifact declaration looses Mule "object" elements
| MULE-15860 | Extension model for Mule core does not contain 'object' construct
| MULE-15854 | Error mappings should be auto created when lazy context is used
| MULE-15848 | MetadataComponent is OUTPUT_ATTRIBUTES when failing in OutputTypeResolver
| MULE-15846 | ArtifactClassLoaderRunner - Keep latest version of services only when more than one version for a service is discovered by transitive dependencies
| MULE-15840 | Add system property -Djava.locale.providers=COMPAT by default
| MULE-15837 | Set metadata type Any to the parameters or return of operation when appropriate
| MULE-15835 | Invalid XML generated for artifact declaration
| MULE-15833 | Add java.xml.soap
| MULE-15832 | MEL broken on JDK 11
| MULE-15829 | Redeployment fails when using secure configuration properties module on Windows
| MULE-15822 | Resource is not found when declaring extension in domain project - part 2
| MULE-15804 | Can't neither un-deploy nor redeploy app that depends on a custom lib on Windows
| MULE-15791 | Wrong location is resolved for redelivery-policy when nested to http listener
| MULE-15777 | Relative log config file path should be resolved consistently regardless of the OS
| MULE-15775 | When using a logger to log a value, its result is evaluated again
| MULE-15765 | Add logging on each retry attempt
| MULE-15755 | Temporal buffer files contain ${} pattern
| MULE-15753 | Add error messages for template parcing validation
| MULE-15746 | Fix backpressure flaky tests
| MULE-15737 | Fix possible race condition in processing strategies
| MULE-15735 | Error resolving value provider from studio when there is a dependency with provided scope
| MULE-15734 | Polling source without `scheduling-strategy` fails on initialization rather than during parse
| MULE-15731 | Policy can not contain duplicated plugin with greater version than the app's one
| MULE-15730 | Keystores can feature no key entries
| MULE-15728 | Resource is not found when declaring extension in domain project.
| MULE-15716 | Leaks through hard references to types, classloaders and schedulers
| MULE-15708 | async in sub-flow must use its own processingStrategy instance
| MULE-15705 | Configuration#defaultResponseTimeout not being initialized with lazyInit
| MULE-15694 | Variables and Payload values set inside UntilSuccessful are not propagated outside of it in case of retry exhausted
| MULE-15689 | Cannot deserialize with a null classloader
| MULE-15678 | Cannot convert InputStream to String in after block of policy source
| MULE-15670 | Debugger marks as failure an operation before execute it
| MULE-15664 | Parallel requests to an API with same x-correlation-id breaks policy engines
| MULE-15660 | SDK Scopes process internal chain blocking
| MULE-15655 | MVELExpressionLanguage breaks if a value of any binding context typed value is null
| MULE-15653 | ExtensionComponent not being initialized when resolving Metadata on Lazy mode and component is inside a sub-flow
| MULE-15643 | Fix illegal reflective access operation to sun.net.www.protocol.jar.Handler
| MULE-15642 | Application failing during init is not logging the error cause
| MULE-15637 | Custom log file in Mule 4
| MULE-15636 | Illegal reflective access operation by DefaultResourceReleaser
| MULE-15630 | Wrong models for repeatable-file-store-stream and repeatable-file-store-iterable
| MULE-15629 | All XML elements on Mule configuration files should support annotations
| MULE-15628 | Not possible to implement a log4j RewritePolicy due to missing exported packages from log4j on Mule Runtime
| MULE-15627 | MetadataCache ID Generator should consider Metadata Category when available
| MULE-15616 | Failed to get method by reflection in DefaultResourceReleaser
| MULE-15608 | SDK doesn't register enums from Subtypes
| MULE-15607 | Fix JDK9 incompatibilities
| MULE-15601 | If you are not using compatibility mode MEL expression is a valid DW object
| MULE-15594 | Grizzly process remaining in case of 204 response
| MULE-15590 | Model validators should only be executed when packaging
| MULE-15587 | Empty foreach log should be in DEBUG
| MULE-15584 | Config parameter must not be called "name"
| MULE-15583 | MavenTestUtils swallows exceptions when running Maven
| MULE-15582 | Error logs when starting and stopping mule
| MULE-15579 | When returning or receiving Object or InputStream the MetadataType should be Any
| MULE-15578 | Extensions are unable to contribute with an ObjectStoreManager to the Object Store Connector
| MULE-15574 | Mule Runtime fails to run batch jobs after stopping app while debugging
| MULE-15573 | ServiceConfigurationError: org.mule.runtime.deployment.model.api.artifact.ArtifactConfigurationProcessor: Error reading configuration file
| MULE-15559 | `lookup` function locks its calling thread
| MULE-15557 | until-sucessful not working properly
| MULE-15553 | Cannot create a log4j rewrite policy with Mule Runtime 4
| MULE-15545 | Mule Runtime log does not show DataWeave syntax error
| MULE-15535 | Inefficient use of String.replaceAll()
| MULE-15534 | CompositeClassNotFoundException is too expensive to create
| MULE-15528 | Mel does not reset collection type on parsing nested collections
| MULE-15519 | When a source start fails and the stop also fails, the start exception is lost
| MULE-15515 | Services class loader model repeats URL for the service itself
| MULE-15514 | DSL SyntaxResolver requires type id
| MULE-15511 | Services throwing UndeclaredThrowableException with checked Exceptions
| MULE-15510 | Unable to use Global Properties on Lazy Contexts
| MULE-15505 | Spring component scan does not work
| MULE-15500 | PollingSources don't release connections when item is rejected
| MULE-15496 | Default Trust Manager Algorithm is equal to the Default Keystore Algorithm
| MULE-15494 | Polling Sources doesn't work on cluster deployments
| MULE-15483 | ClassCastException when resolving Metadata
| MULE-15471 | Test infrastructure assumes only one service per artifact
| MULE-15460 | Shared dependencies' dependencies are not shared
| MULE-15454 | Recurring log warning: ListenerSubscriptionPair has already been registered
| MULE-15441 | Failure to lazy initialize file:list operation with reference to global matcher
| MULE-15424 | Redelivery Policy doesn't work with "typed" payloads
| MULE-15421 | Domain project cannot submit HTTP Request with only the URL
| MULE-15418 | SDK Perf: Avoid field lookup when field is already available
| MULE-15412 | Transactions doesn't work on lazy deployment context
| MULE-15409 | Polling sources watermark is repeating elements when it's value gets updated.
| MULE-15403 | Forbidden flows' names must tell me which one is triggering the exception
| MULE-15402 | Mule fails to process configuration with empty content parameter
| MULE-15401 | FTPS ArtifactFunctionalTestCases are not working due to a class not found exception
| MULE-15393 | Too many temporary events are created for a flow processor
| MULE-15391 | DefaultMessageBuilder is losing message mediaType in serialization
| MULE-15389 | Avoid filling stack traces for classloading exceptions
| MULE-15381 | Performance issue executing components with ParameterResolver parameters
| MULE-15374 | Cannot use Java Module in MuleArtifactFunctionalTestCases
| MULE-15361 | PagingProviderProducer does not close the connection supplier
| MULE-15359 | NPE when deploying a domain with a mule-artifact.json that declares a non existent config resource
| MULE-15336 | Potential leak in IdempotentRedeliveryPolicy
| MULE-15333 | parse template is not setting mimeType to result
| MULE-15329 | Do not fail on smart connectors when connection element is poorly annotated
| MULE-15325 | BindingContext look up is showing significant performance overhead
| MULE-15324 | DslElementSyntax Map entry attribute name is always "key"
| MULE-15321 | TransactionalQueueManager is not initialized and throws a NPE when recovering TXs
| MULE-15317 | DW does not consider Runtime default encoding
| MULE-15316 | Long processor chains generate StackOverflowError
| MULE-15309 | Tooling resolutions fails with NPE on Polling Sources
| MULE-15308 | outputting xml with 2 or more roots gives unclear message
| MULE-15291 | Scheduling Strategy Extension model DSLModel is wrong
| MULE-15289 | Result copy loses length
| MULE-15273 | Unable to debug / Test with MUnit application with transactions
| MULE-15270 | Mime Type Attributes are not added to a source when MetadataScope annotation is used
| MULE-15264 | Message attachments have no order
| MULE-15255 | Sources onResponse not invoked when using a RedeliveryPolicy
| MULE-15249 | CaseInsensitiveMultiMap#keySet is not case insensitive
| MULE-15235 | Connection not released when output is Result<InputStream>
| MULE-15215 | Classloading error when having xerces as mule app dependency
| MULE-15207 | Apps can't be undeployed in Windows if depending on a custom lib
| MULE-15197 | PoolingConnectionHandler returns invalid connections to the pool
| MULE-15195 | Abstract transformer uses new error handler per operation
| MULE-15190 | Making test connection relies on global elements that supports test connection
| MULE-15184 | ResultToMessageIterator consumes 2 messages per iteration
| MULE-15179 | SDK does not support Inner declared Enums as parameters.
| MULE-15177 | SFTP connector fails to move an entire set of files
| MULE-15175 | NPE when executing NullSafe expression in MVEL
| MULE-15170 | security-manager is not initialized on lazy Mule context
| MULE-15167 | Cannot configure mule to deploy a single application using a system property
| MULE-15165 | Changes in HTTP-API module break compilation of HTTP Connector
| MULE-15162 | Operations Stereotypes don't match the allowed stereotypes for Validation All operation
| MULE-15161 | offLineMode for Maven configuration cannot be set on Mule Runtime
| MULE-15159 | Formatting issue in auto-generated jms-documentation.adoc
| MULE-15157 | XML SDK fails to support types constructors
| MULE-15152 | Simultaneous reading and writing causes NPE in grizzly
| MULE-15151 | Operation parameter that is an InputStream is cached
| MULE-15149 | Session properties changes lost with splitter-aggregate
| MULE-15147 | Unable to resolve dynamic metadata from an element inside of a Scatter-Gather
| MULE-15146 | Mule 4 locks on IntrospectionUtils.lambda$getAnnotatedField
| MULE-15141 | Getting NullPointerException on app starting depending on JVM configuration
| MULE-15134 | ComponentModel has wrong ComponentType for SourceModels
| MULE-15133 | ChildEventContext is keeping references to lambda objects
| MULE-15123 | Content/Primary roles parameters with camel case are not properly read by the definition parser
| MULE-15117 | Xml generation is failing with isNotEmptyCollection in validation module
| MULE-15105 | SDK Fails to load extension with Array type with item type with out classes
| MULE-15103 | Mule doesn't log errors that happen inside of a Async Scope
| MULE-15100 | Error on DefaultConnectionManager when restarting muleContext
| MULE-15094 | Add support for security settings on Maven configuration
| MULE-15092 | Add launcher folder to groovy classpath so that WorkCloud can execute script
| MULE-15091 | FlowType in mule-common.xsd is not found
| MULE-15090 | Error when parsing two expressions reading a stream
| MULE-15087 | Resources cannot be loaded on Windows
| MULE-15085 | XML SDK not adding exported resources to the ExtensionModel
| MULE-15067 | Connection 'failsDeployment' doesn't work on sources
| MULE-15066 | RequiredProduct should be auto-detected if possible
| MULE-15065 | Smart Connectors packaging not exporting resource files to the mule-artifact.json correctly
| MULE-15060 | Connectors test fail when using the snapshot version of 1.2.0 SDK
| MULE-15056 | Injection error when OSM has been overriden
| MULE-15053 | Application classloader canâ€™t find schemas within applicationâ€™s libraries on Windows
| MULE-15049 | Make sources ReconnectionStrategy default to the one declared at connection level
| MULE-15041 | When doing testConnectivity reconnection should be forced to set failsDeployment on false
| MULE-15038 | configuration-properties cannot be added on domains
| MULE-15037 | Add support for file encoding for configuration properties and secure configuration properties
| MULE-15036 | Incorrect expression support in `set-payload` component declaration.
| MULE-15034 | Smart connectors do not let export only resources
| MULE-15032 | Dispose method not invoked for ConfigurationPropertiesProvider
| MULE-15028 | Embedded container does not expose JDK resources
| MULE-15027 | app.name is resolved from Domain deployment properties when used as property place holder on file configuration properties
| MULE-15007 | ArtifactClassLoaderRunner - Not considering proxies and mirrors defined on settings.xml
| MULE-15003 | Spring Security reports incorrect Spring version
| MULE-14997 | CGLIB enhanced classes are not serializable
| MULE-14995 | Logger with invalid expression does not throw EXPRESSION error type
| MULE-14984 | Allow FunctionalTestProcessor to fire synchronous notifications
| MULE-14983 | Missing default value for `maxRedeliveryCount` in `idempotent-redelivery-policy`
| MULE-14981 | Groovy script fails to run with mule runtime version 4.1.1
| MULE-14976 | SC not optimizing connection properties
| MULE-14973 | Artifact URL is not escaped when added to Mule Application or Domain class loader
| MULE-14972 | Resource not found when equivalent path than the one exported in mule-artifact.json is used
| MULE-14969 | PartitionInMemoryObjectStore is leaking ExpiryInfo objects
| MULE-14950 | Error deploying HTTP 1.1.1 to runtime 4.1.1
| MULE-14948 | SFTP Connector is not sending header=false as the output mimetype
| MULE-14934 | Cannot deserialize classes loaded by APP classloader in ArtifactFuntionalTestCase
| MULE-14927 | App with a particular Smart Connector not working in Windows
| MULE-14923 | Artemix Full Qualified Queue Name is truncated due to the use of :: separator
| MULE-14920 | Mule fails to parse xml generated with artifact serialization service
| MULE-14912 | Extension model should expose "name" and "config-ref" parameters
| MULE-14910 | The Correlation Id in the MDC should not include format
| MULE-14905 | High GC pressure due to CGLib Enhancer misusage
| MULE-14893 | When requesting datasense for an element in a subflow, an exception signaling an invalid component id is raised
| MULE-14889 | Compilation should fail if OutputResolver is used on Void operations
| MULE-14885 | File connector should use the Mule default encoding if the encoding is not provided.
| MULE-14877 | Properties files packaged in a jar file cannot be use in configuration-properties
| MULE-14873 | Mule tries to connect to internet to download XSD
| MULE-14850 | When policy has source and operation, same pointcuts parameters should be available
| MULE-14849 | DuplicateExportedPackageException: There are multiple artifacts exporting the same package
| MULE-14847 | Operation retry with transaction changes thread
| MULE-14844 | SDK should validate that the given default value of an Enum parameter is a valid value
| MULE-14836 | Failure to evaluate parse expressions for logger when intercepting
| MULE-14828 | Some services are not being stopped
| MULE-14811 | ProcessingStrategy not propagated to `async` children
| MULE-14804 | File watermark picks up existing file
| MULE-14803 | XML SDK modules do not support reading properties from an external file
| MULE-14801 | SimpleRetryPolicy: Use mule schedulers with Mono.delay instead of reactor ones
| MULE-14800 | Review Memory usage in tests of extensions-spring-support
| MULE-14790 | Apps using XML Modules are not resolving config references
| MULE-14788 | TypeAwareConfigurationFactory should lazily add annotations to the configurationType
| MULE-14778 | NameUtils should a compiled regular expression for camelScatterConcat function
| MULE-14770 | Content parameter is recognized as a route when using the aggregators module
| MULE-14769 | ForEach is not non-blocking
| MULE-14768 | Extension with an operation with raw List return type breaks at compile time.
| MULE-14757 | Foreach with child with different processing types behaves asynchronously
| MULE-14755 | Interception API: Error XML-SDK operation with non-blocking operation is handled twice
| MULE-14754 | Flowstack: Exception when flow-ref is combined with failing interceptor and smart connector
| MULE-14752 | The wording in the Info Dialog doesn't make sense and is not consistent
| MULE-14749 | Logger extension model claims DEBUG is default
| MULE-14743 | Processor interceptor after() runs in connector thread and not flow thread when processor is ASYNC_CPU_LITE
| MULE-14739 | EventContext keeps references to already finished ChildContext's results
| MULE-14735 | Avoid iterating parameters map on operation policies
| MULE-14722 | No repeatable streams funtionality in policies
| MULE-14700 | Artifact deployment phases are not displayed on Mule logs when deploying applications from Tooling Runtime Client
| MULE-14696 | Static Metadata resolvers doesn't work with nonblocking operations
| MULE-14691 | Unable to create a Global Property based on a program property
| MULE-14686 | Expiration of an ObjectStore doesn't run if there is another one running
| MULE-14681 | Returned stream is closed when using pooled connections
| MULE-14670 | IllegalStateException when disposing application after initialise phase failed
| MULE-14669 | Policy using a XML module that uses another plugin that is also present in the app, is not deployed
| MULE-14660 | Smart connector using HTTP extension fails to deploy
| MULE-14658 | Too many ThreadGroup instances leaked after redeploys
| MULE-14647 | Smart Connector locations should reflect the operation and not the internal implementation
| MULE-14645 | FlowStack is not working with SmartConnectors
| MULE-14616 | StreamingHelper doesn't support TypedValue properties
| MULE-14608 | Using the interception API (Debugger) with a web service consumer that fails, throws an exception and keeps looping indefenitely (continuously calling before method).
| MULE-14607 | Using the interception API (Debugger) with an http request that fails, does not call after method and throws an Exception
| MULE-14605 | Deadlock when two JDBC connections are created concurrently before the DriverManager classloading takes place
| MULE-14603 | Expression Regex fails on detect expression when this have an unbalanced opening bracket
| MULE-14597 | ExpressionExecutionException when element that expects a DW starts with space
| MULE-14589 | Leak: Do not cache generated CGLIB classes for connectors
| MULE-14588 | Deployment failed due to NoSuchMethodError: Error creating bean with name 'http_request' when running parallel deployments
| MULE-14587 | Properly handle InterruptedException in blocking processors api
| MULE-14582 | Error has no string representation
| MULE-14571 | Services are not being injected when using FakeMuleServer
| MULE-14560 | Not understandable exception is thrown when a transformation fails over a String with '%d'
| MULE-14557 | When a Service/CoreExtension start fails, not started objects are tried to stop
| MULE-14553 | TypeWrapper should not load class until needed
| MULE-14548 | InfrastructureTypeMapping#TYPE_MAPPING keeps references to applications classloader
| MULE-14545 | SoapConnect not using default value at RT
| MULE-14529 | XMLSecureFactories is setting unsupported properties at factories creation.
| MULE-14528 | Log4JMDCAdaptor introduces significant contention
| MULE-14516 | NameClashValidator fail when function parameters clash with another name
| MULE-14503 | JsonLayout in logging needs jackson core and databind libraries to be in lib/boot
| MULE-14456 | Message toString message features exceptionPayload and no data
| MULE-14293 | CXF ProxyService does not work correctly with proactor processing strategy.
| MULE-14188 | Character parameters are not supported
| MULE-13318 | Name Clash validator doesn't validate clashing between elements
| MULE-13034 | Error responses with special characters should be scaped
| MULE-11864 | Mule ObjectStore dispose method shouldn't delete partition_descriptor file
| MULE-10246 | TransformerWeighting violates transitivity requirement for Comparable
| MULE-9343 | Optimize AbstractRegistryBootstrap#initialize
| EE-6681 | Avoid casts to String in JdbcMapStore
| EE-6680 | Escape table names in DefaultDatabaseStoreQueryBuilderStrategy
| EE-6670 | Setting Batch History property throws org.springframework.beans.NotWritablePropertyException: Invalid property 'annotations'
| EE-6666 | Mule 4 JMS Bridge (ActiveMQ) scenario stops working after a certain time
| EE-6664 | Shutting down cluster node(s) causes data corruption in JdbcMapStore
| EE-6642 | OOM on subsequent redeploys of proxy
| EE-6633 | Metadata for DB select is exposing internal implementation instead of a generic type for DB select operation
| EE-6614 | WeakReferences are retained in a non weakreference set in CursorManager
| EE-6579 | Event states leaked in DefualtPolicyStateHandler
| EE-6574 | Organization credentials and encryption key are displayed in plain text in Cluster splash screen.
| EE-6565 | NoSuchElementException on mule-http-caching-policy
| EE-6558 | Mule 4 AMQP Listener scenario stops working after a few seconds
| EE-6548 | Fix ConcurrentModificationExceptions of Kryo serializer on Java 11
| EE-6539 | [REGRESSION] Error handler not working properly on a policy
| EE-6455 | race condition on batch jobs with consumable variables
| EE-6435 | bti:transaction-manager not being lazy initialized
| EE-6421 | On step commit cursor providers are incorrectly closed
| EE-6395 | Batch process deadlock on nested batch jobs
| EE-6377 | Batch Aggregator does not support JSON Payload
| EE-6372 | Mule.bat in windows set the WRAPPER_WORKING_DIR incorrectly
| EE-6371 | Streams eagearly closed in batch:aggregator
| EE-6359 | CheckLicenseAspect validates licences too many times
| EE-6355 | Rate Limit Policy Degradation
| EE-6318 | SynchronizedCollectionsSerializer doesn't synchronize iteration
| EE-6307 | Repeatable streams are closed in streaming batch:aggregator
| EE-6298 | Batch throws NPE if placed in a subflow
| EE-6294 | Wrong length serialized by Kryo for TypedValues of InputStream
| EE-6292 | Kryo serialization fails when deserializing old objects
| EE-6272 | DB errors in a batch step breaks the stream in DW
| EE-6265 | Cannot convert InputStream to String in after block of policy source
| EE-6248 | Fluent-hc dependency is used in cluster discoverySpi and has to be added to the distro
| EE-6244 | License Verification is not performed if another runtime is running.
| EE-6229 | Batch fails to stop if not properly started
| EE-6228 | When license key installed from unpacked zip, trial license is installed instead
| EE-6227 | batch:job changes payload even if target is set
| EE-6219 | Mule 3 License Incorrectly installed in mule 4
| EE-6216 | Cache: Improve non-blocking implementation
| EE-6203 | Transaction incorrectly updated in BTM journal if failover during recovery
| EE-6201 | Cannot lazyInitialize a component twice when using batch
| EE-6200 | Batch job is not setting default value for blockSize
| EE-6184 | There was an error on the Mule Runtime while RE-deploying an application. Mule runtime cannot delete folders from the previous application.
| EE-6182 | BindingContext look up is showing significant performance overhead
| EE-6169 | Cursor Providers closed too early in batch
| EE-6157 | Digested 3.x license not working in 4.x
| EE-6130 | Kryo serializers cannot handle CAS types
| EE-6123 | Failing test in Gateway Concerning Hazelcast Client Mode
| EE-6115 | Mule 4 locks on getIpAddressesRotatedFromRelativeIndex
| EE-6113 | Error handler initialized on each message
| EE-6088 | ee:transform must be CPU_INTENSIVE
| EE-6076 | Windows binary doesn't follow its Unix counterpart regarding the exit statuses
| EE-6001 | Verify Internal and Api DeliveryMode classes
| EE-5988 | Jdbc object store in cluster creates a connection pool for every JdbcMap
| EE-5961 | Api Gateway Autodiscovery not loaded on embedded container on Mule EE 4.1.0
| EE-5960 | Provide capability to transform file names in database cluster object store
| EE-5912 | Cache Key Expression result must be coerced to String
| EE-5905 | dynamic-evaluator throws NPE if expression variable resolved to null
| EE-5901 | JDBCMapStore is commiting auto-commit transactions.
| EE-5900 | Batch continues dispatching work for jobs in stopped flows
| EE-5895 | JdbcMapStore is not SQL92 compliant.
| EE-5894 | Scheduler unavailable when running batch job
| EE-5518 | World-Readable Java KeyStore and Configuration Files
//
// -------------------------------
// - Enhancement Request Issues
// -------------------------------
| MULE-16569 | TestConnectivity should be less verbose
| MULE-16531 | Review/Avoid excessive event creations in policies infrastructure
| MULE-16529 | Performance improvements in flowstack
| MULE-16511 | Improve responsePublisher usage in EventContext
| MULE-16510 | Improve handling of case insensitive var names in event
| MULE-16445 | XML SDL: Support camelized names in operations
| MULE-16286 | NON_LAZY_METADATA_SERVICE key should be API
| MULE-16279 | metadata-model-persistence should be a module that provides a JsonMetadataTypeWriter
| MULE-16212 | Avoid copying the whole event when just setting internal variables
| MULE-16207 | Make cacheID hash generator to only take into account parameters required for metadata
| MULE-16038 | Allow `MavenTestUtils` to pass system properties to a maven build
| MULE-15929 | Interception API: Allow to fail processor with specific message
| MULE-15919 | Add a new service to query ExpressionLanguage Capabilities
| MULE-15850 | Introduce support for WebSockets connector
| MULE-15764 | Enhance RequestMatcherRegistry
| MULE-15760 | Allow SDK sources to implement Initialisable and Disposable
| MULE-15747 | Handle additionalPluginDependencies when creating classloaders (part 2)
| MULE-15741 | Cache results of frequently calculated values
| MULE-15740 | NotificationEmitter: support lazy creation of notification data
| MULE-15739 | Simplify Parameter Group resolution for operators
| MULE-15701 | Add a timestamp to the flowstacks containing its creation date
| MULE-15657 | Add <additionalPluginDependencies> to Mule Maven Plugin
| MULE-15648 | Handle additionalPluginDependencies when creating classloaders
| MULE-15647 | SharedLibraries information should be in the ClassLoaderModel
| MULE-15635 | Configuration properties Extension model should have YAML extension included
| MULE-15622 | Miscellaneous Performance improvements
| MULE-15586 | Add a timeout to lookup function
| MULE-15575 | ArtifactDeclaration has no type information for simple parameter values
| MULE-15525 | Make UntilSuccessful communicate all the errors that occurred before exhaustion
| MULE-15464 | Unable to apply processing strategies to chains in CompositeProcessorChainRouter
| MULE-15434 | Expose metadata resolver and category name  as part of the extension model
| MULE-15427 | Allow developer to declare an element as Required for Metadata
| MULE-15307 | Improve DW message error
| MULE-15182 | XML SDK support stereotypes in parameters
| MULE-15154 | Until successfull should support 0 as a maxRetries value
| MULE-15095 | Overly verbose output
| MULE-14918 | Declare more granular stereotypes to all the Extension Components
| MULE-14913 | Allow Extension developer to mark a parameter as "component ID"
| MULE-14884 | Add support for file-level encryption for Secure Configuration Properties
| MULE-14845 | Smart Connectors: Add support for "config" property type (stereotypes)
| MULE-14723 | Provide a way for intercepting processors to override the publisher of the event context
| MULE-14719 | Add a `maxConcurrency` attribute to `async` scope
| MULE-14693 | Minor performance improvements
| MULE-14627 | SDK should log when trying to reconnect a connection for an operation
| MULE-14568 | Reduce objects allocation in order to reduce CG overhead
| MULE-14566 | Use a CG free thread context implementation for logging
| MULE-14544 | Provide a singleton MultiMap instance
| MULE-14519 | HTTP: Performance improvements in requester
| MULE-14510 | Allows custom schedulers to use a `runInCaller` rejection policy
| MULE-14495 | Move static caches form IntrospectionUtils to an object in the app registry
| MULE-14391 | Change the way that repeated model names are validated
| MULE-14385 | Support for <private-operation>, take 2
| MULE-14383 | Disable RSA encryption ciphers
| MULE-14312 | Add the capability of mark components as deprecated
| MULE-14161 | Add logging on the smart connector's code
| MULE-13743 | Support for Dynamic metadata for SourceCallback response parameters
| MULE-13354 | Introduce split-aggregate router consistent with scatter-gather
| MULE-12184 | Deployment log should print plugins version number
| MULE-11737 | Remove multiple registry capabilities
| MULE-10409 | Move enricher to compatibility
| MULE-9169 | Ensure correct application of lifecycle phases
| EE-6084 | Port should default to AMQPS one when using "useTls"
| EE-6020 | AMQP: Create a global disable flag for fallback creation of AMQP exchange/queues/bindings
| EE-5991 | Allow the user to configure cluster datasource as cluster properties
| EE-5893 | Support file-level encryption for configuration property files
| AGW-2927 | Fix policy violation analytics for automated policies
| AGW-2848 | Fix to avoid returning payload when gatekeeper blocks an API
| AGW-2826 | Exception fixed when disposing runtime in slave mode
| AGW-2810 | Content-Length header is not used in Analytics payload size when the header is set manually
| AGW-2794 | The IP is not being sent to analytics when the proxy uses HTTP Connector v1.4.1 and v1.4.2
| AGW-2715 | Restarting runtime with contracts is deleting them until the next polling cycle
| AGW-2571 | When the HTTP Requester is configured in a sub-flow, operation policies are not applied to it
| AGW-2457 | Fixed cannot deserialize with a null classloader error
| AGW-2409 | Parallel requests to an API with same x-correlation-id breaks policy engine
| AGW-2305 | Downloading template with TRACE enabled logs the content of the file
| AGW-2852 | Reset contracts local db in case of corruption
| AGW-2171 | Reviewed runtime behavior when an API is returned as removed from API Manager
| AGW-2088 | Fixed elements showing as unknown when importing proxy to Studio
|===

== Compatibility Testing Notes

Mule was tested on the following software:

[%header,cols="15a,85a"]
|===
|Software |Version
| JDK | JDK 1.8.0 and JDK 11 (Recommended AdoptOpenJDK 1.8.0_212)
| OS | MacOS 10.14.4, AIX 7.2, Windows 2019 Server, Windows 10, Solaris 11.3, RHEL 7, Ubuntu Server 18.04
| Application Servers | Tomcat 7, Tomcat 8, Weblogic 12c, Wildfly 8, Wildfly 9, Websphere 8, Jetty 8, Jetty 9
| Databases | Oracle 11g, Oracle 12c, MySQL 5.5+, DB2 10, PostgreSQL 9, Derby 10, Microsoft SQL Server 2014
|===

This version of Mule runtime is bundled with the Runtime Manager Agent plugin version '2.3.0'.
